{"version":3,"sources":["../../src/utils/doi.ts"],"sourcesContent":["/**\r\n * DOI工具函数\r\n * 提供DOI验证、标准化、提取等功能\r\n */\r\n\r\n/**\r\n * 验证DOI格式\r\n */\r\nexport function validateDOI(doi: string): boolean {\r\n  if (!doi) return false;\r\n  const normalized = normalizeDOI(doi);\r\n  return /^10\\.\\d{4,}\\/[^\\s]+$/.test(normalized);\r\n}\r\n\r\n/**\r\n * 标准化DOI格式\r\n */\r\nexport function normalizeDOI(doi: string): string {\r\n  return doi\r\n    .replace(/^doi:/i, '')\r\n    .replace(/^https?:\\/\\/(dx\\.)?doi\\.org\\//i, '')\r\n    .trim();\r\n}\r\n\r\n/**\r\n * 从文本中提取DOI\r\n */\r\nexport function extractDOI(text: string): string | null {\r\n  if (!text) return null;\r\n\r\n  const patterns = [\r\n    /\\b(10\\.\\d{4,}\\/[^\\s]+)/gi,\r\n    /doi:\\s*(10\\.\\d{4,}\\/[^\\s]+)/gi,\r\n    /dx\\.doi\\.org\\/(10\\.\\d{4,}\\/[^\\s]+)/gi,\r\n  ];\r\n\r\n  for (const pattern of patterns) {\r\n    const match = text.match(pattern);\r\n    if (match) {\r\n      return normalizeDOI(match[1] || match[0]);\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * 从URL提取DOI\r\n */\r\nexport function extractDOIFromURL(url: string): string | null {\r\n  try {\r\n    const urlObj = new URL(url);\r\n    if (urlObj.hostname.includes('doi.org')) {\r\n      return normalizeDOI(urlObj.pathname.slice(1));\r\n    }\r\n  } catch {\r\n    return null;\r\n  }\r\n  return extractDOI(url);\r\n}\r\n\r\n/**\r\n * 生成DOI的URL\r\n */\r\nexport function getDOIUrl(doi: string): string {\r\n  const normalized = normalizeDOI(doi);\r\n  return `https://doi.org/${normalized}`;\r\n}\r\n"],"mappings":";AAQO,SAAS,YAAY,KAAsB;AAChD,MAAI,CAAC,IAAK,QAAO;AACjB,QAAM,aAAa,aAAa,GAAG;AACnC,SAAO,uBAAuB,KAAK,UAAU;AAC/C;AAKO,SAAS,aAAa,KAAqB;AAChD,SAAO,IACJ,QAAQ,UAAU,EAAE,EACpB,QAAQ,kCAAkC,EAAE,EAC5C,KAAK;AACV;AAKO,SAAS,WAAW,MAA6B;AACtD,MAAI,CAAC,KAAM,QAAO;AAElB,QAAM,WAAW;AAAA,IACf;AAAA,IACA;AAAA,IACA;AAAA,EACF;AAEA,aAAW,WAAW,UAAU;AAC9B,UAAM,QAAQ,KAAK,MAAM,OAAO;AAChC,QAAI,OAAO;AACT,aAAO,aAAa,MAAM,CAAC,KAAK,MAAM,CAAC,CAAC;AAAA,IAC1C;AAAA,EACF;AAEA,SAAO;AACT;AAKO,SAAS,kBAAkB,KAA4B;AAC5D,MAAI;AACF,UAAM,SAAS,IAAI,IAAI,GAAG;AAC1B,QAAI,OAAO,SAAS,SAAS,SAAS,GAAG;AACvC,aAAO,aAAa,OAAO,SAAS,MAAM,CAAC,CAAC;AAAA,IAC9C;AAAA,EACF,SAAQ;AACN,WAAO;AAAA,EACT;AACA,SAAO,WAAW,GAAG;AACvB;AAKO,SAAS,UAAU,KAAqB;AAC7C,QAAM,aAAa,aAAa,GAAG;AACnC,SAAO,mBAAmB,UAAU;AACtC;","names":[]}