{"version":3,"sources":["../../src/api-client/index.ts","../../src/api-client/fetch.ts"],"sourcesContent":["export * from './fetch';\r\n","/**\r\n * API Client工具\r\n */\r\n\r\nexport interface FetchOptions extends RequestInit {\r\n  timeout?: number;\r\n}\r\n\r\n/**\r\n * 带超时的fetch请求\r\n */\r\nexport async function fetchWithTimeout(\r\n  url: string,\r\n  options: FetchOptions = {}\r\n): Promise<Response> {\r\n  const { timeout = 30000, ...fetchOptions } = options;\r\n\r\n  const controller = new AbortController();\r\n  const timeoutId = setTimeout(() => controller.abort(), timeout);\r\n\r\n  try {\r\n    const response = await fetch(url, {\r\n      ...fetchOptions,\r\n      signal: controller.signal,\r\n    });\r\n    clearTimeout(timeoutId);\r\n    return response;\r\n  } catch (error) {\r\n    clearTimeout(timeoutId);\r\n    if (error instanceof Error && error.name === 'AbortError') {\r\n      throw new Error(`请求超时: ${url}`);\r\n    }\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * 构建带查询参数的URL\r\n */\r\nexport function buildUrlWithParams(baseUrl: string, params: Record<string, string>): string {\r\n  const url = new URL(baseUrl, window.location.origin);\r\n  Object.entries(params).forEach(([key, value]) => {\r\n    if (value !== undefined && value !== null) {\r\n      url.searchParams.append(key, value);\r\n    }\r\n  });\r\n  return url.toString();\r\n}\r\n\r\n/**\r\n * 解析API错误\r\n */\r\nexport function parseApiError(error: unknown): string {\r\n  if (error instanceof Error) {\r\n    return error.message;\r\n  }\r\n  if (typeof error === 'string') {\r\n    return error;\r\n  }\r\n  if (error && typeof error === 'object' && 'message' in error) {\r\n    return String((error as { message: unknown }).message);\r\n  }\r\n  return 'Unknown error';\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACWA,eAAsB,iBACpB,KACA,UAAwB,CAAC,GACN;AACnB,QAA6C,cAArC,YAAU,IAfpB,IAe+C,IAAjB,yBAAiB,IAAjB,CAApB;AAER,QAAM,aAAa,IAAI,gBAAgB;AACvC,QAAM,YAAY,WAAW,MAAM,WAAW,MAAM,GAAG,OAAO;AAE9D,MAAI;AACF,UAAM,WAAW,MAAM,MAAM,KAAK,iCAC7B,eAD6B;AAAA,MAEhC,QAAQ,WAAW;AAAA,IACrB,EAAC;AACD,iBAAa,SAAS;AACtB,WAAO;AAAA,EACT,SAAS,OAAO;AACd,iBAAa,SAAS;AACtB,QAAI,iBAAiB,SAAS,MAAM,SAAS,cAAc;AACzD,YAAM,IAAI,MAAM,6BAAS,GAAG,EAAE;AAAA,IAChC;AACA,UAAM;AAAA,EACR;AACF;AAKO,SAAS,mBAAmB,SAAiB,QAAwC;AAC1F,QAAM,MAAM,IAAI,IAAI,SAAS,OAAO,SAAS,MAAM;AACnD,SAAO,QAAQ,MAAM,EAAE,QAAQ,CAAC,CAAC,KAAK,KAAK,MAAM;AAC/C,QAAI,UAAU,UAAa,UAAU,MAAM;AACzC,UAAI,aAAa,OAAO,KAAK,KAAK;AAAA,IACpC;AAAA,EACF,CAAC;AACD,SAAO,IAAI,SAAS;AACtB;AAKO,SAAS,cAAc,OAAwB;AACpD,MAAI,iBAAiB,OAAO;AAC1B,WAAO,MAAM;AAAA,EACf;AACA,MAAI,OAAO,UAAU,UAAU;AAC7B,WAAO;AAAA,EACT;AACA,MAAI,SAAS,OAAO,UAAU,YAAY,aAAa,OAAO;AAC5D,WAAO,OAAQ,MAA+B,OAAO;AAAA,EACvD;AACA,SAAO;AACT;","names":[]}