# Researchopia 插件测试指南

## 🧪 测试环境

- **Zotero 版本**: 8.0-beta.8 或更高
- **插件版本**: 0.1.1
- **开发模式**: 热重载已启用

## ✅ 基本功能测试

### 1. 插件安装和加载

**预期结果**:
- [x] 插件在 Zotero 插件管理器中显示为 "Researchopia (0.1.1)"
- [x] 插件状态显示为 "已启用"
- [x] 没有兼容性警告

**测试步骤**:
1. 启动 Zotero 8 Beta
2. 进入 `工具` > `插件`
3. 确认 Researchopia 插件已安装并启用

### 2. 偏好设置面板

**预期结果**:
- [ ] 在 `编辑` > `偏好设置` 中显示 "Researchopia" 选项卡
- [ ] 偏好设置界面正常加载
- [ ] 登录表单可见且功能正常
- [ ] 设置选项可以保存

**测试步骤**:
1. 打开 `编辑` > `偏好设置`
2. 点击 "Researchopia" 选项卡
3. 尝试输入邮箱和密码
4. 点击 "登录" 按钮
5. 测试各种设置选项

### 3. Item Pane 集成

**预期结果**:
- [ ] 在右侧面板显示 "Shared Annotations" 部分
- [ ] 选择有 DOI 的文献时显示相关功能
- [ ] 按钮可以正常点击
- [ ] 状态信息正确显示

**测试步骤**:
1. 在 Zotero 中选择一篇有 DOI 的文献
2. 查看右侧面板是否显示 "Shared Annotations"
3. 点击各个功能按钮
4. 观察状态信息和反馈

### 4. 环境配置

**预期结果**:
- [x] Supabase 配置正确加载
- [x] 环境变量可以访问
- [x] 调试日志正常输出

**验证方法**:
- 检查 Zotero 调试输出中的 "Researchopia" 相关日志
- 确认配置信息正确显示

## 🔧 开发测试

### 热重载功能

**测试步骤**:
1. 运行 `npm start`
2. 修改源代码文件
3. 观察 Zotero 是否自动重新加载插件

**预期结果**:
- [x] 代码修改后自动重新构建
- [x] Zotero 自动重新加载插件
- [x] 修改立即生效

### 构建系统

**测试命令**:
```bash
npm run build      # 生产构建
npm run build-dev  # 开发构建
npm run lint:check # 代码检查
```

**预期结果**:
- [x] 构建成功，无错误
- [x] TypeScript 编译正常
- [x] 生成的 .xpi 文件可以安装

## 🐛 已知问题和解决方案

### 问题 1: 插件兼容性警告
**症状**: "Add-on researchopia@zotero.plugin is not compatible with application version"
**解决方案**: ✅ 已修复 - 更新了 manifest.json 中的版本范围

### 问题 2: Item Pane 不显示
**症状**: 右侧面板没有显示 "Shared Annotations" 部分
**可能原因**: 
- ItemPaneManager API 调用问题
- 本地化文件缺失
- UI 注册失败

**调试步骤**:
1. 检查 Zotero 调试输出
2. 确认 `researchopia-section-header` 本地化字符串存在
3. 验证 UIManager.registerItemPaneSection() 调用

### 问题 3: 偏好设置不显示
**症状**: 偏好设置中没有 Researchopia 选项卡
**可能原因**:
- 偏好设置注册失败
- XHTML 文件路径错误
- 脚本加载失败

**调试步骤**:
1. 检查 preferences.xhtml 文件是否存在
2. 验证 bootstrap.js 中的偏好设置注册代码
3. 查看控制台错误信息

## 📊 测试结果记录

### 基本功能测试结果

| 功能 | 状态 | 备注 |
|------|------|------|
| 插件加载 | ✅ 通过 | 无兼容性问题 |
| 热重载 | ✅ 通过 | 开发体验良好 |
| 构建系统 | ✅ 通过 | TypeScript 编译正常 |
| 偏好设置 | ⏳ 待测试 | 需要用户验证 |
| Item Pane | ⏳ 待测试 | 需要用户验证 |
| Supabase 连接 | ⏳ 待测试 | 需要网络测试 |

### 性能测试

- **启动时间**: < 2 秒
- **内存使用**: 正常范围
- **响应速度**: 良好

## 🚀 下一步测试计划

1. **用户界面测试**
   - 验证所有 UI 组件正常显示
   - 测试用户交互流程
   - 检查响应式设计

2. **功能集成测试**
   - 测试标注提取功能
   - 验证数据上传和下载
   - 测试社交功能

3. **错误处理测试**
   - 网络连接失败
   - 无效用户输入
   - 权限错误

4. **性能和稳定性测试**
   - 大量数据处理
   - 长时间运行稳定性
   - 内存泄漏检查

## 📝 测试反馈

请在测试过程中记录以下信息：

1. **测试环境**:
   - Zotero 版本
   - 操作系统
   - 插件版本

2. **发现的问题**:
   - 问题描述
   - 重现步骤
   - 预期行为 vs 实际行为
   - 错误信息或截图

3. **改进建议**:
   - 用户体验改进
   - 功能增强建议
   - 性能优化建议

---

**测试完成后，请将结果反馈给开发团队，以便进一步优化插件功能。**
