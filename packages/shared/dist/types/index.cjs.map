{"version":3,"sources":["../../src/types/index.ts"],"sourcesContent":["/**\r\n * 核心数据类型 - 三端共享\r\n * 统一网站、Zotero插件、浏览器扩展的类型定义\r\n */\r\n\r\n// ========== 论文相关 ==========\r\n\r\nexport interface Paper {\r\n  id: string;\r\n  doi: string;\r\n  title: string;\r\n  abstract?: string;\r\n  authors?: string[];\r\n  journal?: string;\r\n  year?: number;\r\n  pdf_url?: string;\r\n  keywords?: string[];\r\n  publication_date?: string;\r\n  view_count?: number;\r\n  created_by?: string;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\n// ========== 标注相关 ==========\r\n\r\nexport interface AnnotationPosition {\r\n  pageIndex: number;\r\n  rects: number[][]; // [[x1, y1, x2, y2], ...]\r\n}\r\n\r\nexport interface Annotation {\r\n  id: string;\r\n  paper_id: string;\r\n  user_id: string;\r\n  session_id?: string;\r\n  content: string;\r\n  comment?: string;\r\n  color: string;\r\n  type: 'highlight' | 'underline' | 'note' | 'image';\r\n  position: AnnotationPosition;\r\n  show_author_name?: boolean;\r\n  quality_score?: number;\r\n  created_at: string;\r\n  updated_at?: string;\r\n}\r\n\r\n// 带用户信息的标注（用于显示）\r\nexport interface AnnotationWithUser extends Annotation {\r\n  username?: string;\r\n  users?: {\r\n    username: string;\r\n    avatar_url: string | null;\r\n  };\r\n}\r\n\r\n// ========== 用户相关 ==========\r\n\r\nexport interface User {\r\n  id: string;\r\n  email: string;\r\n  username: string;\r\n  avatar_url?: string;\r\n  bio?: string;\r\n  role: 'user' | 'admin';\r\n  created_at: string;\r\n  updated_at?: string;\r\n}\r\n\r\nexport interface UserProfile {\r\n  id: string;\r\n  username: string;\r\n  email: string;\r\n  bio?: string;\r\n  avatar_url?: string;\r\n  institution?: string;\r\n  website?: string;\r\n  created_at: string;\r\n}\r\n\r\n// ========== 阅读会话相关 ==========\r\n\r\nexport interface ReadingSession {\r\n  id: string;\r\n  paper_id: string;\r\n  title: string;\r\n  description?: string;\r\n  creator_id: string;\r\n  is_public: boolean;\r\n  member_count?: number;\r\n  annotation_count?: number;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport interface SessionMember {\r\n  session_id: string;\r\n  user_id: string;\r\n  role: 'creator' | 'member';\r\n  joined_at: string;\r\n}\r\n\r\n// ========== 评分和评论 ==========\r\n\r\nexport interface Rating {\r\n  id: string;\r\n  paper_id: string;\r\n  user_id: string;\r\n  overall_score: number;\r\n  novelty_score?: number;\r\n  methodology_score?: number;\r\n  clarity_score?: number;\r\n  significance_score?: number;\r\n  comment?: string;\r\n  created_at: string;\r\n  updated_at?: string;\r\n}\r\n\r\nexport interface Comment {\r\n  id: string;\r\n  paper_id: string;\r\n  user_id: string;\r\n  content: string;\r\n  parent_id?: string;\r\n  created_at: string;\r\n  updated_at?: string;\r\n}\r\n\r\n// ========== 跨端通信协议 ==========\r\n\r\nexport interface CrossPlatformMessage {\r\n  type: string;\r\n  source: 'website' | 'zotero-plugin' | 'browser-extension';\r\n  timestamp: number;\r\n  data: any;\r\n}\r\n\r\nexport interface AuthMessage extends CrossPlatformMessage {\r\n  type: 'AUTH_STATUS' | 'AUTH_STATUS_RESPONSE' | 'AUTH_LOGIN' | 'AUTH_LOGOUT';\r\n  data: {\r\n    authenticated: boolean;\r\n    user?: {\r\n      id: string;\r\n      name: string;\r\n      email: string;\r\n      username: string;\r\n    };\r\n    token?: string;\r\n  };\r\n}\r\n\r\nexport interface AnnotationSyncMessage extends CrossPlatformMessage {\r\n  type: 'ANNOTATION_SYNC' | 'ANNOTATION_UPDATE' | 'ANNOTATION_DELETE';\r\n  data: {\r\n    sessionId: string;\r\n    annotations: Annotation[];\r\n  };\r\n}\r\n\r\n// ========== 数据库查询结果类型 ==========\r\n\r\nexport interface PaperWithStats extends Paper {\r\n  averageRating: number;\r\n  commentCount: number;\r\n  favoriteCount: number;\r\n}\r\n\r\nexport interface SessionWithDetails extends ReadingSession {\r\n  paper?: Paper;\r\n  creator?: {\r\n    username: string;\r\n    avatar_url?: string;\r\n  };\r\n  members?: SessionMember[];\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;AAAA;AAAA;","names":[]}