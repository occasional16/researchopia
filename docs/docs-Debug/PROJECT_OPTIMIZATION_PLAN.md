# Researchopia é¡¹ç›®ä¼˜åŒ–æ–¹æ¡ˆ

**ç‰ˆæœ¬**: v1.0  
**æ—¥æœŸ**: 2025-11-02  
**ç›®æ ‡**: è§„èŒƒåŒ–é¡¹ç›®ç»“æ„ï¼Œæå‡ä»£ç è´¨é‡ï¼Œä¾¿äºAIé•¿æœŸå¼€å‘å’Œç»´æŠ¤

---

## ä¸€ã€æ€»ä½“ç­–ç•¥

### ä¼˜åŒ–åŸåˆ™
1. **æ¸è¿›å¼æ”¹è¿›**: åˆ†é˜¶æ®µè¿›è¡Œï¼Œé¿å…å¤§è§„æ¨¡é‡æ„å¸¦æ¥çš„é£é™©
2. **ä¼˜å…ˆçº§é©±åŠ¨**: å…ˆè§£å†³å½±å“æœ€å¤§ã€é£é™©æœ€å°çš„é—®é¢˜
3. **æŒç»­éªŒè¯**: æ¯ä¸ªé˜¶æ®µå®Œæˆåè¿›è¡Œæµ‹è¯•éªŒè¯
4. **æ–‡æ¡£å…ˆè¡Œ**: å…ˆå®Œå–„æ–‡æ¡£ï¼Œå†è¿›è¡Œä»£ç é‡æ„

### ä¸‰é˜¶æ®µè®¡åˆ’
- **Phase 1**: åŸºç¡€è®¾æ–½å·©å›º (1-2å‘¨)
- **Phase 2**: ä»£ç æ¨¡å—åŒ–é‡æ„ (2-3å‘¨)  
- **Phase 3**: åŠŸèƒ½å®Œå–„ä¼˜åŒ– (1-2å‘¨)

---

## äºŒã€Phase 1: åŸºç¡€è®¾æ–½å·©å›º (ä¼˜å…ˆçº§: P0)

### 1.1 æ–‡æ¡£æ•´ç† (3å¤©)

#### ä»»åŠ¡æ¸…å•
- [ ] æ›´æ–°æ ¹ç›®å½• `README.md`
  - é¡¹ç›®ç®€ä»‹å’Œæ ¸å¿ƒåŠŸèƒ½
  - å¿«é€Ÿå¼€å§‹æŒ‡å—
  - é¡¹ç›®ç»“æ„è¯´æ˜
  - æ–‡æ¡£å¯¼èˆªé“¾æ¥

- [ ] åˆ›å»º `docs/ARCHITECTURE.md`
  - æ•´ä½“æ¶æ„å›¾
  - æŠ€æœ¯æ ˆè¯´æ˜
  - å„æ¨¡å—èŒè´£

- [ ] åˆ›å»º `docs/CONTRIBUTING.md`
  - å¼€å‘ç¯å¢ƒé…ç½®
  - ä»£ç è§„èŒƒ
  - æäº¤æµç¨‹

- [ ] æ•´åˆç°æœ‰æ–‡æ¡£
  - åˆå¹¶ `README-extension.md` å’Œ `README-Zotero Plugin.md`
  - ç§»åŠ¨åˆ° `docs/` ç»Ÿä¸€ç®¡ç†

#### æ–‡æ¡£æ¨¡æ¿

**README.md ç»“æ„**:
```markdown
# Researchopia - ç ”å­¦æ¸¯

## é¡¹ç›®ç®€ä»‹
å­¦æœ¯ç ”ç©¶åä½œå¹³å°ï¼ŒåŒ…å«ç½‘ç«™ã€Zoteroæ’ä»¶å’Œæµè§ˆå™¨æ‰©å±•

## å¿«é€Ÿå¼€å§‹
### ç½‘ç«™å¼€å‘
npm install && npm run dev

### Zoteroæ’ä»¶å¼€å‘  
cd zotero-plugin && npm start

### æµè§ˆå™¨æ‰©å±•
åŠ è½½ extension/ åˆ°Chrome

## æ–‡æ¡£
- [æ¶æ„è¯´æ˜](./docs/ARCHITECTURE.md)
- [å¼€å‘æŒ‡å—](./docs/CONTRIBUTING.md)
- [APIæ–‡æ¡£](./docs/API.md)
```

### 1.2 APIä»£ç†æ”¹é€ æ”¶å°¾ (5å¤©)

#### å½“å‰çŠ¶æ€
âœ… å·²å®Œæˆ: Auth, PaperRegistry, ReadingSession, Annotations  
ğŸ”œ å¾…å®Œæˆ: æ¸…ç†å’Œä¼˜åŒ–ï¼›å½“å‰æ’ä»¶ç›´æ¥è°ƒç”¨Supabaseå­˜åœ¨å®‰å…¨é£é™©,åº”å…¨éƒ¨èµ°Next.jsä»£ç†

#### ä»»åŠ¡æ¸…å•
- [ ] æ¸…ç† `env.ts` ä¸­çš„ç›´æ¥Supabaseé…ç½®
- [ ] ç¼–å†™ API æ–‡æ¡£ (`docs/API.md`)
- [ ] æ·»åŠ é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•(æ ¸å¿ƒAPI)

#### éªŒæ”¶æ ‡å‡†
- æ‰€æœ‰æ’ä»¶APIè°ƒç”¨èµ°Next.jsä»£ç†
- æ— ç›´æ¥Supabaseå®¢æˆ·ç«¯è°ƒç”¨
- ç¼–è¯‘æ— é”™è¯¯ï¼ŒåŠŸèƒ½æµ‹è¯•é€šè¿‡

---

## ä¸‰ã€Phase 2: ä»£ç æ¨¡å—åŒ–é‡æ„ (ä¼˜å…ˆçº§: P1)

### 3.1 æå–å…±äº«å·¥å…·æ¨¡å— (3å¤©)

**ç›®æ ‡**: åˆ›å»ºå¯å¤ç”¨çš„å·¥å…·æ¨¡å—ï¼Œå‡å°‘ä»£ç é‡å¤

#### ä»»åŠ¡æ¸…å•

**Day 1**: æ‰©å±•ç°æœ‰å·¥å…·
- [ ] `annotationUtils.ts`: æ·»åŠ æ›´å¤šæ ‡æ³¨å¤„ç†å‡½æ•°
- [ ] `styles.ts`: ç»Ÿä¸€æ ·å¼å¸¸é‡
- [ ] `helpers.ts`: é€šç”¨å·¥å…·å‡½æ•°

**Day 2**: åˆ›å»ºUIç»„ä»¶åº“
- [ ] `uiHelpers.ts`: ç»Ÿä¸€çš„UIç»„ä»¶åˆ›å»º
  - createButton() - æŒ‰é’®
  - createCard() - å¡ç‰‡
  - createInput() - è¾“å…¥æ¡†
  - createDialog() - å¯¹è¯æ¡†

**Day 3**: æµ‹è¯•å’Œæ–‡æ¡£
- [ ] ç¼–è¯‘æµ‹è¯•
- [ ] åŠŸèƒ½æµ‹è¯•
- [ ] ç¼–å†™ä½¿ç”¨æ–‡æ¡£

### 3.2 é‡æ„ readingSessionView.ts (7å¤©)

**å½“å‰çŠ¶æ€**: 2653è¡Œï¼ŒåŒ…å«å¤šä¸ªåŠŸèƒ½æ¨¡å—  
**ç›®æ ‡**: å‡å°‘åˆ° 1200-1500è¡Œ

#### é‡æ„è®¡åˆ’

**Day 1-2**: æå–æ ‡æ³¨æ¨¡å—
```typescript
// åˆ›å»º sessionAnnotationsView.ts (~400è¡Œ)
export class SessionAnnotationsView {
  async render(container: HTMLElement): Promise<void>
  async refresh(): Promise<void>
  private renderAnnotationCards(): void
  private createToolbar(): HTMLElement
}
```

**Day 3-4**: æå–æˆå‘˜æ¨¡å—
```typescript
// åˆ›å»º sessionMembersView.ts (~300è¡Œ)
export class SessionMembersView {
  async render(container: HTMLElement): Promise<void>
  async refresh(): Promise<void>
  private createMemberCard(): HTMLElement
}
```

**Day 5**: æå–äº‹ä»¶æ¨¡å—
```typescript
// åˆ›å»º sessionEventsView.ts (~200è¡Œ)
export class SessionEventsView {
  async render(container: HTMLElement): Promise<void>
  private createEventCard(): HTMLElement
}
```

**Day 6-7**: æå–èŠå¤©æ¨¡å—
```typescript
// åˆ›å»º sessionChatView.ts (~400è¡Œ)
export class SessionChatView {
  async render(container: HTMLElement): Promise<void>
  async sendMessage(text: string): Promise<void>
  private loadMessages(): Promise<void>
}
```

#### é‡æ„æµç¨‹æ¨¡æ¿
```
æ¯ä¸ªæ¨¡å—:
1. åˆ›å»ºæ–°æ–‡ä»¶å’Œç±»ç»“æ„
2. å¤åˆ¶ç›¸å…³æ–¹æ³•
3. æ›´æ–°å¯¼å…¥å’Œå¼•ç”¨
4. ç¼–è¯‘æµ‹è¯•
5. åŠŸèƒ½æµ‹è¯•
6. Git commit
```

### 3.3 é‡æ„ sharedAnnotationsView.ts (5å¤©)

**å½“å‰çŠ¶æ€**: 1722è¡Œ  
**ç›®æ ‡**: å‡å°‘åˆ° 1200-1400è¡Œ

#### é‡æ„è®¡åˆ’

**Day 1-3**: æå–è¯„è®ºæ¨¡å—
```typescript
// åˆ›å»º annotationCommentsView.ts (~500è¡Œ)
export class AnnotationCommentsView {
  async render(container: HTMLElement): Promise<void>
  async addComment(text: string): Promise<void>
  async deleteComment(id: string): Promise<void>
}
```

**Day 4-5**: ä¼˜åŒ–ä¸»æ–‡ä»¶
- å°†ç‚¹èµåŠŸèƒ½è¿ç§»åˆ° `annotationUtils.ts`
- æ¸…ç†é‡å¤ä»£ç 
- æµ‹è¯•å’ŒéªŒè¯

---

## å››ã€Phase 3: åŠŸèƒ½å®Œå–„ä¼˜åŒ– (ä¼˜å…ˆçº§: P2)

### 4.1 ä¿®å¤å·²çŸ¥é—®é¢˜ (3å¤©)

#### é—®é¢˜æ¸…å•
- [ ] æ ‡æ³¨å®æ—¶åŒæ­¥: ç§»é™¤é‡å¤ç›‘å¬å™¨ (å·²ä¿®å¤ï¼Œéœ€æµ‹è¯•)
- [ ] èŠå¤©æ¶ˆæ¯æ˜¾ç¤º: è°ƒæŸ¥å¹¶ä¿®å¤
- [ ] äº‹ä»¶æ—¶é—´è½´: æ·»åŠ æ ‡æ³¨äº‹ä»¶æ—¥å¿—

### 4.2 æ€§èƒ½ä¼˜åŒ– (2å¤©)
- [ ] å‡å°‘ä¸å¿…è¦çš„APIè°ƒç”¨
- [ ] ä¼˜åŒ–æ ‡æ³¨åˆ—è¡¨æ¸²æŸ“
- [ ] æ·»åŠ ç¼“å­˜æœºåˆ¶

### 4.3 ç”¨æˆ·ä½“éªŒæå‡ (3å¤©)
- [ ] æ·»åŠ åŠ è½½çŠ¶æ€æç¤º
- [ ] æ”¹è¿›é”™è¯¯æç¤º
- [ ] æ·»åŠ æ“ä½œç¡®è®¤å¯¹è¯æ¡†

---

## äº”ã€å¼€å‘è§„èŒƒ

### Git å·¥ä½œæµ
```bash
# ä¸»åˆ†æ”¯
main - ç¨³å®šç‰ˆæœ¬
dev  - å¼€å‘åˆ†æ”¯

# åŠŸèƒ½åˆ†æ”¯
feature/xxx  - æ–°åŠŸèƒ½
refactor/xxx - é‡æ„
fix/xxx      - ä¿®å¤
```

### æäº¤è§„èŒƒ
```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤bug
refactor: é‡æ„
docs: æ–‡æ¡£æ›´æ–°
test: æµ‹è¯•
chore: æ„å»º/å·¥å…·
```

### æµ‹è¯•æ¸…å•
æ¯æ¬¡é‡æ„å:
- [ ] `npm run build` ç¼–è¯‘æˆåŠŸ
- [ ] æ’ä»¶åŠ è½½æˆåŠŸ
- [ ] æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] æ— æ§åˆ¶å°é”™è¯¯

---

## å…­ã€é‡Œç¨‹ç¢‘å’Œæ—¶é—´çº¿

### Week 1: åŸºç¡€å·©å›º
- Day 1-3: æ–‡æ¡£æ•´ç†
- Day 4-5: APIä»£ç†æ”¶å°¾

### Week 2-3: æ ¸å¿ƒé‡æ„
- Week 2: æå–å·¥å…· + é‡æ„ readingSessionView (å‰åŠ)
- Week 3: å®Œæˆ readingSessionView + é‡æ„ sharedAnnotationsView

### Week 4: æ”¶å°¾ä¼˜åŒ–
- Day 1-3: ä¿®å¤å·²çŸ¥é—®é¢˜
- Day 4-5: æ€§èƒ½å’Œä½“éªŒä¼˜åŒ–

---

## ä¸ƒã€é£é™©æ§åˆ¶

### å¤‡ä»½ç­–ç•¥
- æ¯ä¸ªé‡æ„å‰åˆ›å»º Git tag
- ä¿ç•™åŸä»£ç è‡³å°‘1ä¸ªç‰ˆæœ¬

### å›æ»šæ–¹æ¡ˆ
- åŠŸèƒ½å¼€å…³: `useNewModules` é…ç½®
- å¿«é€Ÿå›æ»š: `git revert`

### è´¨é‡ä¿è¯
- ä»£ç å®¡æŸ¥
- åŠŸèƒ½æµ‹è¯•
- æ€§èƒ½ç›‘æ§

---

## å…«ã€ç«‹å³è¡ŒåŠ¨æ¸…å•

### ä»Šå¤©å¯ä»¥åš
1. [ ] åˆ›å»º `docs/` æ–‡ä»¶å¤¹
2. [ ] å¤‡ä»½å½“å‰ README.md
3. [ ] æŒ‰æ¨¡æ¿é‡å†™ README.md å‰3èŠ‚
4. [ ] åˆ›å»º CONTRIBUTING.md æ¡†æ¶

### æ˜å¤©å¯ä»¥åš
1. [ ] å®Œæˆæ‰€æœ‰æ–‡æ¡£åˆç‰ˆ
2. [ ] æ•´ç† env.ts é…ç½®
3. [ ] åˆ—å‡ºç¼ºå¤±çš„APIç«¯ç‚¹
4. [ ] ç»˜åˆ¶æ¶æ„å›¾

---

## ä¹ã€æˆåŠŸæ ‡å‡†

### Phase 1 å®Œæˆæ ‡å‡†
- âœ… æ–‡æ¡£å®Œæ•´ä¸”æœ€æ–°
- âœ… APIå…¨éƒ¨èµ°ä»£ç†
- âœ… ç¼–è¯‘å’Œæµ‹è¯•é€šè¿‡

### Phase 2 å®Œæˆæ ‡å‡†
- âœ… readingSessionView.ts < 1500è¡Œ
- âœ… sharedAnnotationsView.ts < 1400è¡Œ
- âœ… æ–°å¢4ä¸ªè§†å›¾æ¨¡å—
- âœ… åŠŸèƒ½æ— é€€åŒ–

### Phase 3 å®Œæˆæ ‡å‡†
- âœ… å·²çŸ¥é—®é¢˜å…¨éƒ¨ä¿®å¤
- âœ… æ€§èƒ½æå‡å¯æµ‹é‡
- âœ… ç”¨æˆ·ä½“éªŒæ”¹å–„

---

## åã€å‚è€ƒèµ„æº

### ç›¸å…³æ–‡æ¡£
- `CODE_MODULARIZATION_GUIDE.md` - æ¨¡å—åŒ–è¯¦ç»†æŒ‡å—
- `API_PROXY_MIGRATION_PROGRESS.md` - APIæ”¹é€ è¿›åº¦
- `README-extension.md` - æ‰©å±•å¼€å‘æ–‡æ¡£
- `README-Zotero Plugin.md` - æ’ä»¶å¼€å‘æ–‡æ¡£

### å·¥å…·å’Œå‘½ä»¤
```bash
# ç»Ÿè®¡æ–‡ä»¶è¡Œæ•°
(Get-Content file.ts).Count

# æŸ¥æ‰¾å¤§æ–‡ä»¶
Get-ChildItem -Recurse -Filter "*.ts" | Where-Object { 
  (Get-Content $_.FullName).Count -gt 1000 
}

# ç¼–è¯‘æ£€æŸ¥
npm run build

# å¯åŠ¨å¼€å‘
npm start
```

---

**æ³¨æ„**: æœ¬æ–‡æ¡£ä¸ºæŒ‡å¯¼æ€§æ–‡ä»¶ï¼Œå®é™…æ‰§è¡Œæ—¶åº”æ ¹æ®é¡¹ç›®è¿›å±•çµæ´»è°ƒæ•´ã€‚ä¼˜å…ˆä¿è¯åŠŸèƒ½ç¨³å®šï¼Œå†è¿½æ±‚ä»£ç ä¼˜åŒ–ã€‚

**ç»´æŠ¤è€…**: Researchopia Team  
**æœ€åæ›´æ–°**: 2025-11-02
