import { BasicTool } from "../basic.js";
export class PatchHelper extends BasicTool {
    options;
    constructor() {
        super();
        this.options = undefined;
    }
    setData(options) {
        this.options = options;
        const Zotero = this.getGlobal("Zotero");
        const { target, funcSign, patcher } = options;
        const origin = target[funcSign];
        this.log("patching ", funcSign);
        target[funcSign] = function (...args) {
            if (options.enabled)
                try {
                    // eslint-disable-next-line ts/no-unsafe-function-type
                    return patcher(origin).apply(this, args);
                }
                catch (e) {
                    Zotero.logError(e);
                }
            // eslint-disable-next-line ts/no-unsafe-function-type
            return origin.apply(this, args);
        };
        return this;
    }
    enable() {
        if (!this.options)
            throw new Error("No patch data set");
        this.options.enabled = true;
        return this;
    }
    disable() {
        if (!this.options)
            throw new Error("No patch data set");
        this.options.enabled = false;
        return this;
    }
}
//# sourceMappingURL=patch.js.map